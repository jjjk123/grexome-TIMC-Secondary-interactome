# Download grexome-TIMC-Secondary
git clone git@github.com:manojmw/grexome-TIMC-Secondary.git

# Build interactome
mkdir data
cd data

## Download and parse Uniprot data
wget https://ftp.uniprot.org/pub/databases/uniprot/current_release/knowledgebase/complete/uniprot_sprot.dat.gz
gunzip -c uniprot_sprot.dat.gz | python3 grexome-TIMC-Secondary/UniProt_Interactome_Data/Uniprot_parser.py > Uniprot_output.tsv
started: 23/01/2024 17:20
finished: 23/01/2024 17:25

## Download PPI data from BioGRID, Intact and Reactome
wget https://downloads.thebiogrid.org/Download/BioGRID/Latest-Release/BIOGRID-ORGANISM-LATEST.mitab.zip
unzip BIOGRID-ORGANISM-LATEST.mitab

wget https://ftp.ebi.ac.uk/pub/databases/intact/current/psimitab/intact.zip
unzip -t intact.zip
	# if ok:  
	unzip intact.zip

wget https://reactome.org/download/current/interactors/reactome.homo_sapiens.interactions.psi-mitab.txt

## Parse BioGRID data
python3 ../grexome-TIMC-Secondary/UniProt_Interactome_Data/Interaction_parser.py --inInteraction BIOGRID-ORGANISM-Homo_sapiens*.mitab.txt --inUniProt Uniprot_output.tsv > Exp_Biogrid.tsv
I 2024-01-23 17:26:37: Interaction_parser.py - starting to run
I 2024-01-23 17:26:46: Interaction_parser.py - ALL DONE, completed successfully!
# BIOGRID-ORGANISM-Homo_sapiens-4.4.229.mitab.txt has 1203845 interactions
# Exp_Biogrid.tsv has 1116086 interactions

## Parse Intact data
python3 ../grexome-TIMC-Secondary/UniProt_Interactome_Data/Interaction_parser.py --inInteraction intact.txt --inUniProt Uniprot_output.tsv > Exp_Intact.tsv
I 2024-01-26 14:40:23: Interaction_parser.py - starting to run
I 2024-01-26 14:40:43: Interaction_parser.py - ALL DONE, completed successfully!
# intact.txt has 1284458 interactions
# Exp_Intact.tsv has 676297 interactions

## Parse Reactome data
python3 ../grexome-TIMC-Secondary/UniProt_Interactome_Data/Interaction_parser.py --inInteraction reactome.homo_sapiens.interactions.psi-mitab.txt --inUniProt Uniprot_output.tsv > Exp_Reactome.tsv
I 2024-01-23 17:30:13: Interaction_parser.py - starting to run
I 2024-01-23 17:30:14: Interaction_parser.py - ALL DONE, completed successfully!
# reactome.homo_sapiens.interactions.psi-mitab.txt has 106922 interactions
# Exp_Reactome.tsv has 68584 interactions

## Build high-quality interactome
	# First create .tsv with columns ['GENE, 'ENSG']
	take tsv with ['ENSG', 'GENE'] from Manoj: luxor/home/nthierry/FromManojWagleHome/MultiOmics-ExomeSeq-Phenotype/GTEX_Data/E-MTAB-5214-query-results.tpms.tsv
	use geneName_to_ENSG.ipynb method 2 to modify it and save to canonicalGenes.tsv

	# build interactome
	python3 ../grexome-TIMC-Secondary/UniProt_Interactome_Data/Build_Interactome.py --inExpFile Exp_Biogrid.tsv Exp_Intact.tsv Exp_Reactome.tsv --inUniProt Uniprot_output.tsv --inCanonicalFile canonicalGenes.tsv > Interactome_human.tsv
	I 2024-01-26 14:43:48: Build_Interactome.py - starting to run
	I 2024-01-26 14:43:52: Build_Interactome.py - ALL DONE, completed successfully!
	# interactome has 92075 interactions
	
	# if created from BioGRID and Intact only (no Reactome), then interactome has 85143 interactions
	python3 ../grexome-TIMC-Secondary/UniProt_Interactome_Data/Build_Interactome.py --inExpFile Exp_Biogrid.tsv Exp_Intact.tsv --inUniProt Uniprot_output.tsv --inCanonicalFile canonicalGenes.tsv > Interactome_human_no_Reactome.tsv
	I 2024-01-26 14:46:01: Build_Interactome.py - starting to run
	I 2024-01-26 14:46:05: Build_Interactome.py - ALL DONE, completed successfully!

# Prepare list of candidate genes for infertility
cp sshMounts/luxor/home/kubicaj/Spz-ExomeSeq_2401/Metadata/candidateGenes_allPhenotypes.xlsx .
run candidateGenes.ipynb

# Analyze interactome with networkx
run humanInteractomeAnalysis.ipynb

# test Harmonic Centrality - sum of reciprocal of the shortest path disances to the node from all other nodes
# HC turns out to be problematic - it doesn't take into account that high-score proteins can be hubs
# and the other way around - that high-scoring proteins can stick to hubs
# also it scores to high in small networks
run test_harmonicCentrality.ipynb

# test Eigenvector Centrality - element of the left eigenvector associated with the adjacency matrix eigenvalue corresponding to the node
# EVC doesn't take into account any additional information about the known genes (no prior knowledge)
run test_eigenvectorCentrality.ipynb

# test Katz Centrality - the most promising so far, because it takes into account additional information about the known genes (prior knowledge - beta)
# and it penalizes contribution from far nodes with alpha^distance
# However, it turns out to be problematic as well
run test_katzCentrality.ipynb
run test_katzCentrality_ENSG00000146223.ipynb
run test_katzCentrality_leaveOneOut.ipynb

# test a new strategy, ie. score=1 for known genes and score=sum_overOtherNodes(alpha^distance * adjacancy_matrix_element^distance * score_other_node)
# notebook contains: score for every non-MMAF gene in interactome, new MMAF candidates from RDV 13/02/2024 with bio/med collaborators, 
#  leave-one-out experiments for known MMAF genes
run test_newCentrality20240213.ipynb

# created a python script for scoring
# example usage:
cd newCentrality_v1
python newCentrality_v1.py --interactome /home/kubicaj/calc/data/Interactome_human.tsv --causal_genes /home/kubicaj/calc/data/candidateGenesList_MMAF.p --canonical_genes /home/kubicaj/calc/data/canonicalGenes.tsv --new_candidates CLHC1 PHF20 NUSAP1 --phenotype MMAF -o /home/kubicaj/calc/newCentrality

# the above script needs improvements in terms of scoring algorithm and calculation efficiency
# therefore, created a new folder newCentrality_v2 with improved code
# created newCentrality_v3 for the same reasons

# created newCentrality_v4 for the same reasons
# Previously, git was not used properly (because code editing was done locally, then copied to git repository and then pushed)
# Now, working only in git repository grexome-TIMC-Seconday-interactome
# Cleanup: all to old/
#  keep only newCentrality_v4 and necessary data:
#	data/(interactome.sif, causal genes, canonical genes)
#	newCentrality_v4.py
#	interactome_TSV_to_SIF.py
#
# example use:
# python newCentrality_v4.py -i data/Interactome_human.sif --causal_genes_file data/causalGenes_allPhenotypes.csv --canonical_genes_file data/canonicalGenes.tsv
